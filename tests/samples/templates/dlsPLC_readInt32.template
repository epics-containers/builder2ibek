#! Generated by VisualDCT v2.6
#! DBDSTART
#! DBD("../../dbd/dlsPLC_vdct.dbd")
#! DBDEND


# % macro, __doc__, Read the Int32 value stored in 2 DM variables in a PLC
# % macro, P, device prefix
# % macro, Q, device suffix
# % macro, addr, DM variable of the int
# % macro, timeout, Timeout in seconds for the FINS protocol reads/writes
# % macro, scale, Scaling of raw value into EGUs
# % macro, roffset, Pre scaling offset in cts
# % macro, offset, Offset of value in EGUs
# % macro, name, Object name and gui association name
#
# This associates an edm screen with the template
# % gui, $(name=), edmembed, dlsPLC_readSingle.edl, P=$(P),Q=$(Q)

#% archiver 0.5 Monitor VAL
record(longin, "$(P)$(Q)_RAW")
{
	field(DTYP, "asynInt32")
	field(INP,  "@asyn($(port), $(addr), $(timeout=0)) FINS_DM_READ_32")
	field(SCAN, "$(scan=1 second)")
}

#% autosave 1 VAL
#% archiver 0.5 Monitor VAL
record(ai, "$(P)$(Q)_RAW_OFF") {
	field(DESC, "Pre scale offset")
	field(VAL, "$(roffset=0)")
}

#% autosave 1 VAL
#% archiver 0.5 Monitor VAL
record(ai, "$(P)$(Q)_SF") {
	field(DESC, "Scale Factor")
	field(VAL, "$(scale=1)")
}

#% autosave 1 VAL
#% archiver 0.5 Monitor VAL
record(ai, "$(P)$(Q)_OFF") {
	field(DESC, "Offset in EGUs")
	field(VAL, "$(offset=0)")
}

#% archiver 0.5 Monitor VAL
record(calcout, "$(P)$(Q)")
{
	field(INPA, "$(P)$(Q)_RAW CP")
	field(INPB, "$(P)$(Q)_SF CP")
	field(INPC, "$(P)$(Q)_OFF CP")
	field(INPD, "$(P)$(Q)_RAW_OFF CP")
	field(CALC, "((A+D)*B)+C")
	field(EGU, "$(egu=mm)")
	field(PREC, "$(prec=3)")
}
